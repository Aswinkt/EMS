<div class="container py-4">
  <div class="card shadow-sm">
    <div class="card-body">
      <h3 class="mb-4">Form Builder</h3>
      <div class="mb-4" style="max-width: 600px; margin: 0 auto;">
        <input class="form-control rounded-pill" [(ngModel)]="formName" name="formName" placeholder="Form Name" required>
      </div>

      <div class="mb-4" style="max-width: 600px; margin: 0 auto;">
        <div cdkDropList (cdkDropListDropped)="drop($event)">
          <div *ngFor="let field of fields; let i = index" cdkDrag class="card mb-2 p-2 d-flex flex-row align-items-center shadow-sm">
            <span cdkDragHandle class="me-3 text-secondary" style="cursor: grab;">
              <i class="bi bi-grip-vertical"></i>
            </span>
            <div class="flex-grow-1">
              <strong>{{ field.label }}</strong> <span class="text-muted">({{ field.type }})</span>
              <span *ngIf="field.required" class="badge bg-info ms-2">Required</span>
            </div>
            <button class="btn btn-link text-danger p-0 ms-3 rounded-pill" (click)="removeField(i)" title="Remove">
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </div>
      </div>

      <form (ngSubmit)="addField()" class="mb-0" style="max-width: 600px; margin: 0 auto;">
        <div class="row g-2 align-items-end">
          <div class="col-md-6">
            <label class="form-label mb-1">Field Label</label>
            <input type="text" class="form-control rounded-pill" [(ngModel)]="newField.label" name="label" required placeholder="Enter label">
          </div>
          <div class="col-md-4">
            <label class="form-label mb-1">Type</label>
            <select class="form-select rounded-pill" [(ngModel)]="newField.type" name="type">
              <option *ngFor="let t of fieldTypes" [value]="t.value">{{ t.label }}</option>
            </select>
          </div>
          <div class="col-md-2 d-flex align-items-center pt-4">
            <div class="form-check">
              <input type="checkbox" class="form-check-input rounded-pill" [(ngModel)]="newField.required" name="required" id="requiredCheck">
              <label class="form-check-label" for="requiredCheck">Required</label>
            </div>
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-6 pe-1">
            <button type="submit" class="btn btn-primary w-100 rounded-pill">
              <i class="bi bi-plus-lg me-1"></i> Add Field
            </button>
          </div>
          <div class="col-6 ps-1">
            <button type="button" class="btn btn-success w-100 rounded-pill" (click)="saveForm()" [disabled]="fields.length === 0 || !formName">
              <i class="bi bi-save me-1"></i> Save Form
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Divider -->
  <hr class="my-5" style="border-top: 2px dashed #dee2e6; max-width: 600px; margin: 2rem auto;">

  <!-- List of existing forms (improved UI) -->
  <div class="card shadow-lg border-0" style="max-width: 700px; margin: 0 auto; background: #f8fafc; border-radius: 1.5rem;">
    <div class="card-body p-4">
      <div class="d-flex align-items-center mb-4">
        <i class="bi bi-ui-checks-grid fs-3 text-primary me-2"></i>
        <h5 class="mb-0 fw-bold">Existing Forms</h5>
      </div>
      <div class="table-responsive">
        <table class="table table-borderless table-hover align-middle mb-0">
          <thead class="table-light rounded-pill">
            <tr>
              <th class="ps-3">Title</th>
              <th>Created By</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let form of forms">
              <td class="ps-3 fw-semibold">{{ form.name }}</td>
              <td>{{ form.created_by }}</td>
            </tr>
            <tr *ngIf="forms.length === 0">
              <td colspan="2" class="text-center text-muted py-4">No forms found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
